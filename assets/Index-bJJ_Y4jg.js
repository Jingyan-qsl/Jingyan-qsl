import{_ as A,l as d,k as L,n as O,a as n,m as $,o as r,c as i,w as j,F as k,q as G,u as M,d as t,e as a,s as C,t as P,f as c,x as q,b as m,E as v}from"./index-DW0o-UDa.js";const W={"element-loading-text":"加载中..."},H={class:"image-slot"},J={class:"card_B"},K={class:"dialog-footer"},h="140px",Q={__name:"Index",setup(R){let x=d([]),y=L();const s=d({quantity:"1",name:"",phone:""}),V=d(0),b=d(),u=d(!1),_=d(!0);O(()=>{w()});const w=l=>{_.value=!0,C({url:"getsubmenu",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:y.token},params:{size:10,page:l}}).then(e=>{e.data.status==200?(console.log("获取成功:",e),x.value=e.data.data,_.value=!1,V.value=e.data.max_pages*10):e.data.status==401&&(alert("身份认证过期,请重新登录"),P.push("/login"),localStorage.clear())}).catch(e=>{alert("获取失败"),console.log("获取失败:",e)})},T=l=>{u.value=!0,b.value=l},S=()=>{C({url:"addorder",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:y.token},data:{order_foot_id:b.value,order_num:s.value.quantity}}).then(l=>{l.data.status==200?(console.log("成功:",l),u.value=!1,v({message:"下单成功",type:"success"})):v({message:l.data.msg,type:"danger"})}).catch(l=>{console.log("请求失败:",l),v({message:"请求失败",type:"danger"})})};return(l,e)=>{const B=n("icon-picture"),E=n("el-icon"),F=n("el-image"),p=n("el-button"),U=n("el-card"),z=n("el-pagination"),f=n("el-input"),g=n("el-form-item"),D=n("el-form"),I=n("el-dialog"),N=$("loading");return r(),i(k,null,[j((r(),i("ul",W,[(r(!0),i(k,null,G(M(x),o=>(r(),i("li",null,[t(U,{style:{"max-width":"200px"}},{header:a(()=>[c(q(o.name),1)]),default:a(()=>[t(F,{src:o.img},{error:a(()=>[m("div",H,[t(E,null,{default:a(()=>[t(B)]),_:1})])]),_:2},1032,["src"]),m("div",J,[m("h3",null,"￥"+q(o.price),1),t(p,{type:"primary",onClick:X=>T(o.id)},{default:a(()=>[c("下单")]),_:2},1032,["onClick"])])]),_:2},1024)]))),256))])),[[N,_.value]]),t(z,{background:"",layout:"prev, pager, next",total:V.value,onCurrentChange:w},null,8,["total"]),t(I,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value=o),title:"下单",width:"500"},{footer:a(()=>[m("div",K,[t(p,{onClick:e[3]||(e[3]=o=>u.value=!1)},{default:a(()=>[c("取消")]),_:1}),t(p,{type:"primary",onClick:S},{default:a(()=>[c(" 提交 ")]),_:1})])]),default:a(()=>[t(D,{model:s.value},{default:a(()=>[t(g,{label:"购买数量","label-width":h},{default:a(()=>[t(f,{modelValue:s.value.quantity,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.quantity=o),autocomplete:"off",placeholder:"必填"},null,8,["modelValue"])]),_:1}),t(g,{label:"客户名称","label-width":h},{default:a(()=>[t(f,{modelValue:s.value.name,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.name=o),autocomplete:"off",placeholder:"选填"},null,8,["modelValue"])]),_:1}),t(g,{label:"客户电话","label-width":h},{default:a(()=>[t(f,{modelValue:s.value.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.phone=o),autocomplete:"off",placeholder:"选填"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}},Z=A(Q,[["__scopeId","data-v-e53aa6aa"]]);export{Z as default};
