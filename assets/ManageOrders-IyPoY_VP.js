import{k as B,n as E,l as m,a as n,m as F,o as y,c as $,w as A,y as D,e as o,d as e,F as J,s as b,t as w,f as g,b as M,E as u}from"./index-DW0o-UDa.js";const P={class:"dialog-footer"},G={__name:"ManageOrders",setup(j){let f=B();E(()=>{_(1)});const h=m([{id:"",order_id:"",order_foot:"",order_price:"",order_sum:"",order_num:"",order_custom:"",order_phone:"",createtime:"",updatetime:"",order_created:""}]),a=m([{order_id:"",order_price:"",order_num:"",order_custom:"",order_phone:""}]),V=m(0),v=m(!0),_=d=>{v.value=!0,b({url:"getorder",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:f.token},params:{size:10,page:d}}).then(l=>{l.data.status==200?(h.value=l.data.data,v.value=!1,V.value=l.data.max_pages*10):l.data.status==401&&(alert("身份认证过期,请重新登录"),w.push("/login"),localStorage.clear())}).catch(l=>{alert("请求失败")})},k=d=>{b({url:"delorder",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:f.token},data:{order_id:d}}).then(l=>{l.data.status==200?(u({message:"删除成功",type:"success"}),_()):l.data.status==401?(u({message:"身份认证过期,请重新登录",type:"danger"}),w.push("/login"),localStorage.clear()):u({message:l.data.msg,type:"danger"})}).catch(l=>{u({message:"请求失败",type:"danger"})})},p=m(!1),x=d=>{a.value=JSON.parse(JSON.stringify(d)),p.value=!0},C=()=>{b({url:"reorder",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:f.token},data:a.value}).then(d=>{d.data.status==200?(u({message:"修改成功",type:"success"}),p.value=!1,_()):d.data.status==401?(u({message:"身份认证过期,请重新登录",type:"danger"}),w.push("/login"),localStorage.clear()):u({message:d.data.msg,type:"danger"})}).catch(d=>{u({message:"请求失败",type:"danger"})})};return(d,l)=>{const r=n("el-table-column"),c=n("el-button"),S=n("el-table"),T=n("el-pagination"),s=n("el-input"),i=n("el-form-item"),U=n("el-form"),O=n("el-dialog"),N=F("loading");return y(),$(J,null,[A((y(),D(S,{data:h.value,border:"",style:{width:"100%"},"element-loading-text":"加载中...","header-cell-style":{"text-align":"center"}},{default:o(()=>[e(r,{prop:"id",label:"序号",width:"60"}),e(r,{prop:"order_id",label:"订单编号",width:"160"}),e(r,{prop:"order_foot",label:"菜品名称",width:"85"}),e(r,{prop:"order_price",label:"单价",width:"80"}),e(r,{prop:"order_sum",label:"总价",width:"80"}),e(r,{prop:"order_num",label:"数量",width:"60"}),e(r,{prop:"order_custom",label:"客户名称",width:"120"}),e(r,{prop:"order_phone",label:"客户电话",width:"150"}),e(r,{prop:"createtime",label:"创建时间",width:"160"}),e(r,{prop:"updatetime",label:"更新时间",width:"160"}),e(r,{prop:"order_created",label:"创建者",width:"150"}),e(r,{label:"操作",width:"180"},{default:o(t=>[e(c,{type:"primary",onClick:z=>x(t.row)},{default:o(()=>[g("修改")]),_:2},1032,["onClick"]),e(c,{type:"danger",onClick:z=>k(t.row.order_id)},{default:o(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[N,v.value]]),e(T,{background:"",layout:"prev, pager, next",total:V.value,onCurrentChange:_,style:{"margin-top":"20px"}},null,8,["total"]),e(O,{modelValue:p.value,"onUpdate:modelValue":l[8]||(l[8]=t=>p.value=t),title:"修改订单",width:"500"},{footer:o(()=>[M("div",P,[e(c,{onClick:l[6]||(l[6]=t=>p.value=!1)},{default:o(()=>[g("取消")]),_:1}),e(c,{type:"primary",onClick:l[7]||(l[7]=t=>C())},{default:o(()=>[g(" 修改 ")]),_:1})])]),default:o(()=>[e(U,{model:a.value},{default:o(()=>[e(i,{label:"订单编号"},{default:o(()=>[e(s,{modelValue:a.value.order_id,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.order_id=t),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"菜品名称"},{default:o(()=>[e(s,{modelValue:a.value.order_foot,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.order_foot=t),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"客户姓名"},{default:o(()=>[e(s,{modelValue:a.value.order_custom,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.order_custom=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"客户电话"},{default:o(()=>[e(s,{modelValue:a.value.order_phone,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.order_phone=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"菜品单价"},{default:o(()=>[e(s,{modelValue:a.value.order_price,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.order_price=t),disabled:""},null,8,["modelValue"])]),_:1}),e(i,{label:"菜品数量"},{default:o(()=>[e(s,{modelValue:a.value.order_num,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.order_num=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}};export{G as default};
